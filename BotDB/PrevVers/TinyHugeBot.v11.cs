using ChessChallenge.API;
using static System.AppDomain;

class MyBot : IChessBot {
    //TinyBot_asmBuf either holds the TinyBot IChessBot instance, or the assembly buffer during decoding
    dynamic TinyBot_asmBuf = new byte[9216];
    int asmBufOff, scaleParity;
    byte scaleAccum;

    public MyBot() {
        //Decode the assembly
        //The assembly is encoded in a semi-RLE-like format
        //There are two types of tokens:
        // - scaling factors 0-15: regular tokens
        //   - the decimal integer number encodes 12 bytes, which are copied to the assembly buffer
        //   - the decimal scaling factor encodes an additional 4 bits - two regular tokens are paired up, and their scaling factors are combined to form an extra byte
        // - scaling factor 16: skip tokens (can skip up to 255 bytes forward to efficiently encode a stretch of zero bytes)
        //   - the lowest byte of the decimal integer number contains the amount of bytes to skip forward by
        //   - the remaining 11 integer number bytes are copied to the assembly buffer
        //   - skip tokens are invisible to the scalar accumulator; they don't contribute their scale value, nor do they affect parity
        // - the sign bit is unused as a minus sign would require an extra token
        foreach(decimal dec in new[] {
//>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> BEGIN ENCODED ASSEMBLY <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
            73786.976307732568653M,19807040628566.084401472995583M,31105283551.3167525259001891M,882796876544M,152038078167460301897952M,7737125245.5336267181203469M,73786978493861462528M,4352132950.6126650289423364M,41277563240262130762296328704M,7555786.3725983042899970M,1152921504606846992M,0.0000309237645936M,3892174455.1939676298292740M,9444733003122685772288M,0.0000412316868620M,3163985579.5516792144677017M,1099512153600M,944473.2966838802055477M,326431738453956854441574404M,991319175405429854563.21002M,290919781640315.35772132725248M,29091978164031535772132725248M,123311927817080170671374418M,129356298659891911221.182526M,1733157140020289470.5126563328M,22283336281007940863904473600M,139028111039830691994206303M,96716039386267713989.378141M,2692566337500793911085.1595520M,28782375095264302739373447168M,129356686045458263416111172M,118476464342072736654.491751M,27545053684474989803468779.264M,45495056752884172056101437952M,74956647473182435590144150M,172881317546.359415645667506M,69944594489218467.511715016960M,29091978177506293765365593088M,113640539703248186609893458M,1136405397032481866098.93458M,71192413929524733958768798.72M,16403928636509074447854010881M,37235315547315391562763495.1M,40378622291041060807639063.9M,62049536282407940806156.6977M,6810219170867177267988086273M,35180398063206541391822882.9M,31311770875850314073283.0050M,2909299349148848181156518.4769M,31568878292641922202780905985M,42796461017633910912666857.3M,4521438460091021876498271.00M,2168090419141.800692193269249M,10833741527619139207004496385M,32883641919673228585035406.6M,3094898798293361588566757.38M,321877585885463718363.77633025M,19808254301540275727924006913M,36630900597184930337010506.1M,290146808505.557556693827852M,55722980155712.58965491794432M,11143084867382696331851164161M,35301235304513573292605475.2M,33729731351488855264.3035480M,4023447273589195.3141105631745M,33735141135850376782046896129M,45939743781746332169692802.9M,4630241230459646091132275.71M,136191255076388623442238154.25M,14857164718421857917462477313M,34817744298033165492571378.5M,373565161896777651.482657129M,35901710934753.763711262994945M,45186223446643187137040690177M,48357578819609612910959030.5M,4388455513162545241951439.75M,1485691915370741.3037570413313M,8667582579571765612889858049M,34213220513660760707910899.1M,3493856124811870670560.95601M,3125930828137679708873982.8225M,68708099510146076950172602625M,58512944933149524957947545.9M,523473955818.166128475636211M,62118012405066376.4131958017M,75826051677088479811658177538M,61897835771400259779513589.4M,61051639348637.8802628723149M,5725706914271846.6972729865217M,68089157824774357017677660929M,58392050505866260505047910.8M,563368950587869545800008184M,621335962216706634315588.610M,621128177947307798253666306M,6274417792383492608275911.28M,61535287152949593604181248.1M,7830217731878843026.6621885186M,13929295278470689356085595393M,6298599444677242542180275.17M,61535287153034049411540633.9M,37161152257255884932661944.34M,41785312066414390666923736066M,1079589849553252634858357.743M,1107394387085067.265299907570M,3718131711738.578917587648259M,4956104808742267382300641796M,122224067977582992070528.2961M,123674865660479927.4085188504M,550932383556471.40126829837315M,60663779635250008692044858883M,1169050138863228078373143.544M,11593787138573.15227287815165M,74590420911474882155229.981443M,78923286609215378118295147779M,1218614123673974577259742.177M,127422598420749.9463802487726M,5478395640772872311938.4574211M,61901818846969684817216792835M,1161797672306536851163907.074M,1120692626450067945909781533M,1857364830292848595898176256.4M,14240777887433228329758737156M,1571540847610602394543.8140M,79195521000628.441773796687851M,708720766907225264259061578.23M,4332487906404207578276956159M,79222118051188368417221443541M,792257444228123.68771553886216M,6994372555324906445.4100880383M,64372844261962.365094410064127M,79181014813120.418315061166062M,79188268404926527821088686104M,7118065500423341306.791578880M,8355953596199413712880137216M,4835039203271627398840295M,27805330749.409796121362423M,6808882722993689299616010239M,79228105847956.228777694997504M,79218491439746.843626504454161M,79193104108206675234895167505M,736575126151883457.36193359616M,4951604318326949987500421631M,79115730918849122091053350914M,7911573091882772958.9090058158M,541594375328157.12776819286783M,35280034954656.213820189418239M,78977910442343.590917588385540M,7913748791268519541028768.9502M,2971003202497667580758167.7567M,25067785214161.207019184287231M,79086716459340.298391542235074M,7911814834619043768.7041064872M,625154525194191268193091991.03M,50445631582419.298635676095999M,79118148696681.671380986363817M,79135073436804354478.405320607M,504456599153211932.45590926079M,52921610829533.264749126462463M,79106059881203.442234363871185M,791157304761022127097.87434949M,541594375328157204737.69779455M,54159437532815.712776819286783M,79130237807305.553902853619618M,78863062452559.128472329846690M,92732636593185193518005.4782M,308243014393.674039365123839M,78892074274150.897391596732120M,78918671177137997.413967003288M,43017188521346329726144158718M,14544477891089.990337532190206M,788328393623715.58624668876528M,7875788479941761.1752067497720M,6932297046127715436763221478.2M,73655826713996.505892536621566M,788703137569577.13160694398623M,78911417898913308.146329386652M,51373194065018213481893.003006M,46730928362070.700926001142014M,788860321169018.94068256112379M,788231672917450.84222983634683M,6188203187732675982.109089278M,78917364670059.219378390374655M,789114182678555.08133125750480M,788872392534129475342.67678402M,53539546633982.483815617981694M,48278343965147.427136740450046M,788098687941214.44647783759599M,787167814875604.33495126900432M,6622814869791121600178805.1966M,67156339273843.305235320041214M,788703130744290.26579198377584M,788594333323508387820.49910421M,34351372127664182471233031166M,47659284221190.067627411557886M,787566757444645.96088717246173M,7877601861291894.3834436665028M,6777542735351280552.1371860990M,62823671917152.483729626531070M,788884474597889.95319112728184M,78878775942554710081.087602319M,35589420782531595750858479.870M,46730947253121.922562992826110M,788038241834805.30214181797600M,788134955900425.13767095336672M,739645183475855975958.79080958M,75821537020798.635732214083837M,7859709395756798.8771338124804M,7859709331192969.4327265295875M,76749831491315490332753134.589M,3092403876706.245607327399421M,785983026620331.48453347917305M,78681718672714.047900294249987M,79225791848531226.683032612605M,616759915234.657137021815805M,786043484901636.75742248828471M,786164371027234978288606244.31M,2506592457964487258.2483543806M,16400315969943.901486479967486M,786587492481665.70217581903361M,78672047321514251633878695432M,3092606937168028383810.828286M,1236027444830.504270736267518M,786067658437410.96386633530934M,7862610854617643621145391.8738M,792237895311312967725.40726526M,60964003943595.738266498515707M,779358033806228114.52637707325M,77996249487159183276991052.868M,198019356788438031081.51918332M,33729091690637.395564502443004M,78038560470457941.611187993616M,78074827525616043.051906104290M,4947240780574962234678.857723M,73962232686034.468498063507708M,780010848952784772.97439603760M,780022941346955560539994184.74M,15469400550864416169.785033212M,35895415925042.564272412689148M,78086917743051044.199984659466M,780917532618609360109615175.65M,786049186783740378262701626.84M,924148156362.807415832078587M,78011966500480913.378176334972M,780083399074864139600548.97780M,4022845162588675.3524882872572M,5880139631335878489286918652M,79210029254162513127311278095M,15715500704478539735171070M,278528480873834219404734848.0M,9284441683021450446024732416M,79226953293290343817603055605M,7922211751623729.3883566915561M,2475965080230728768965044.991M,70872199473620.173124412642304M,79196730719646.229778080858142M,483572173026935473733635.6M,139266979414521711.44369007360M,4332842087277127523182307584M,56819310613895222779576339M,19342517974.654512939204587M,3713787063308372270.882233343M,74895580159954.075641482053632M,21760517180.799550968561680M,26596146680444426898440.207M,71800588393700460637947.169536M,155107098250053184026313343.9M,4345101882259.280376637250138M,2914247047459970156228275661.2M,1238423609655113.6717260723085M,5880413599784826869771141.125M,39974832277773021721133060M,157049873624.4433797033000962M,2726251480608832210615182007.5M,1331640781248575719602953165.3M,2724080588551321741847363742.2M,2724677012270195511582642381.5M,351141960230691727167232589.8M,1393536833345118051846947251.9M,5452994035770613756418943022.2M,960325426974575701113596211.7M,9941025577746612634026.979608M,2734390460952598485135314.4680M,13938914700476150699456665631M,4147102053708377267256511.7969M,1145215428996.9676943427109379M,464274738398297672067843280M,39626170515793100777159853056M,35182561373634170978306M,3962617051569986645.5824060453M,1552628665772210661651.9589891M,340554403391318.31325263134723M,151263807.500824495685132M,1208909681.073185877880575M,3510829324437773620864900970M,1548890410568943344383.7034527M,5810725561976578124476M,2179740476432863833227329.536M,310693935723460790101535100.8M,14696152144922644287.469580M,12389072132389143306688334336M,309485035935017.4839330177024M,13670986699852.039595086777854M,43308355950043.33002665755405M,78644706500158001012640579587M,1705965458873258.8162235760643M,67115698525388969147.3492066M,787873202518395271.98434263047M,5297575273820106130792121101M,15679767880771092559754.30745M,3553046269113331837287225367M,95185200280151429743616M,123794025106322309744043495.4M,9300.989500661603M,34357671794419133807350267904M,36146882020892452650549.2480M,30363428109110965578469.604886M,25968477756765277180333566M,5266080870852409075987122688M,526608087092446707376451.9573M,4652004847248036347264275716M,93691751012287540407723882.4M,37138225677206678784150864168M,12379402879567189414397870.08M,4172013224572180557251745903M,21132627627720500323484672M,4442363874780196567354114150.4M,33113687125073398516764704768M,1331049226296584730668590.8575M,24993472777029350858.29868551M,9913272871381789906166614033M,3626779766957436265562624M,78635803000374519351762160942M,1331026423526808467448208081.1M,38069274322996688956875937281M,1516843025942988.9665908604928M,38690644330347689435990025M,495036707747582205103806873.6M,63473327896995380640.4616224M,30948506042804109.15991453709M,221718416041157314441012.9170M,590755013.689169936416M,18617457635381893296501173.75M,980481702125362267224539135M,369286120222019617889767.3M,527333442653937674097447117.8M,14696190187113530281308937M,3692854494098573624570122M,68086846412821567147097482.41M,42359811818819295.00196876M,309485032246287579588683392.0M,1240720574305341590722756634.7M,311823568203711805573300226.8M,4307890987981538343821547879.4M,185691011715201824097278848.9M,12385525358819353596255.536403M,248322337689837070584.9057292M,810181016.75966850924556M,61897003176469697349.5014154M,6310592799597570.48862736397M,1856910154068889652301.096196M,94187697086993528051194.93907M,3472278641082.3610610358487554M,78626330147055437700632284670M,36147822949233.3533964271622M,309485045158389850641748277.4M,1237940177276288768945624.844M,64943422845106383660.7907098M,380694898689731556.54343589895M,5274749319494014737160601607M,231510613759423.9990067582999M,531205343286.3148976243344386M,5576855179740102930634706951M,13003206115710562945655114.280M,5261245259196587700805578779M,684192625671128794718.75M,38795733497152364598782067204M,28223728762551.576970456727552M,101841891216565392512.10M,133078554805465707.85346059010M,133078554805468522603228352.02M,67159456057275828861940007168M,3094850586115419922354933758M,68232814024350610.95256363523M,74276402947564.170400891082509M,2214776046994.219983767076896M,1362346604322.6817455316534786M,3094850714955524911481032963M,9913258756307798539587.032623M,2234366507934808572925315924.0M,3762205798434569322893.084179M,433045822989.1574213028350466M,4160589338862260568784897M,78616526441843897856864103169M,2189101129856.832404738539789M,272625053642184.91220864795413M,56686916596100910023699M,5881424113652965415170635776M,94900676882982948734343736.0M,3806908503706408644859.4879576M,5102913977701767589394382864M,7791975532236660284966634496M,63105928024798515291.0588674M,377692604588825793.07666866191M,13629429692095959693009976066M,123843022832667457687842432.22M,3435767179441913366929054106.1M,9912001684491196405.306228736M,309485315312434651175321599M,38720442943616.310598192136M,560856593226.9126214386122498M,258609543019617350005130.0196M,5591367276395393.032164212768M,151449007104155520598048M,40789157707200263185547381.76M,13310264235268195603756357163M,6810082240403538.234697075720M,1237940380190426176365986349M,2353092683103940392488.6912800M,55158477853722956869721533032M,308492.9716438312158211M,468024014042355562531824633.55M,35786093207.5656137663518211M,1239036582035.1810260100646402M,1550449802380659151819.3483780M,75523626973944794959374241.30M,16296925000410752636950533M,49492759038895874928388M,1360060473714107868748.715780M,272625053122683439975826.28887M,3126523954738920627163230925.0M,3246386540845598848994902.537M,17677543.6688792683152386M,5265079765302527218101588234M,14701973961953.236754474M,31975143455791980425959681M,34379446957629896840051821834M,1393891470088851269982198172.3M,139389147027099382961.51964418M,13104775050789543989559825922M,1512517302485012.13274188M,1237940380190442829166345984M,1333212638531548854977.1935520M,640967264255033465978946591M,33795881365925908710.660M,32238524353467.529673598248454M,59286194430583.91939876389645M,651973700153.0256708183591426M,6831644529009.721048603561000M,43304195095278.52170914824973M,16252302104930706391043M,376228104292346036093976665.7M,94537056465.2422201995233794M,71436233203692253453688.56320M,479615354514546.90628883M,12384302284275544263970468362M,5906835535404245121549860.864M,173445488653123801.10086610950M,3094850322459798262.907928577M,63659861312154474906481M,66028139354309208494198.2737M,71230586857192209353617.83043M,40439186151428551430.72468498M,1050575465203033225727.521027M,86516349728660187864.81925M,5266080871212697084831794688M,5278401617857508.965919759983M,30948504515872893618862.86605M,19502453026382125715815599.377M,66851003916207708438811M,682075947535786076.5103951405M,4330372285928062889809871358M,13336959792889560.956484659200M,537006764032315464957788216.3M,12379401772762657137.28852824M,35325683812602621464090M,2726259980932465085795821.5194M,35325715366424863643667M,6365990213049437415.3754M,1332728836730943909707306.9828M,416058933886.2260736557842M,46628457757222247290195806.72M,527816108961703.5877156921351M,5278162461661472823775995904M,44372460506806224182258439720M,71375798751091064451408.85522M,102523070078478324.87006227M,13307855459220341191947125760M,3036342810911096557862059983.0M,6647930305731910958316387936M,1553824538292602113894648320M,1057450755122324182964871791.4M,590805388751049174030070990.1M,12383112377051619693387518214M,6468849212801009600.3554869248M,22829150736527621082090745.42M,22341558875966443062558720M,4500072480848451808044450816M,250682961270747263112504.68169M,30948537046.9603245736067591M,4363738645860564040049020300.5M,12380911921945506635737333.76M,62380572360.4852472091413762M,5412365616785836319866617888M,92326026146510880769024M,2576704491927803257675700.5569M,5666839779443.5759341890M,6914111193281275686.2137856M,1083197540499.6032338948260611M,257295682190574.37008843636736M,1980220492528889476239946356M,464847304749394457370624M,971464590.6954305348305413M,1844.6768263821130242M,332041393339656830995M,309485012487476048.144891904M,1416709.9453006982153731M,14167099451907470524672M,897539585090.5153432411177221M,35064106092575752416460810M,464238730355229292848152582M,1858723462861655693716.521216M,3097277436307003628450783232M,12099035137420061973676041M,72606384997.81744812622496M,464232239865573876365.7878784M,2475927329906173748936015872M,7083657810790014648704M,120894426664017786096859.4M,4951774324745395956541841664M,1516481270627.9863236524282115M,8028491.3952396719176963M,1449772491021291379247616M,55363594644215758931M,553658464440095.21239M,303295309627080939.70746966784M,31257985992172120380828300032M,114847952864234647498784771M,131772914338839412994998275M,46422751473205881279757680.640M,4487532642409.9345050690912515M,293130293645920041752M,68142272889805305020550M,2075952313.0776743653180930M,2380072714.5754690775451139M,2521743709.0623287027951107M,3118650832.4980408075716099M,1758137048.7843963738293763M,773713469033.8657756536935171M,37141143218140564646799608064M,168046038484748677115478028M,19585522459972921597663650.5M,371465129867256820853125.6576M,11142414296313747686813756160M,43525369448632029220700661M,30225709659286726.468370807M,4611338453882770994.2299921153M,3713938193303415735795638784M,79305742221542470951744330.3M,787012940691.304080305881183M,6502386971372303247692794112M,7737351919773555912301616129M,36630970688085188554188393.2M,244208863189316434845.237257M,4240040029691651641276009318.4M,2786021522841622685195302144M,1209977410690608797385140M,317950977033528338607508.480M,637548328967670569817217.03681M,1547425092917746916730750976M,1208935044112591706129006M,0.0001099511652620M,43.2345564227592967M,43.2345564227601929M,2011773928996.0233885713478921M,3881286952.13312M,15536455536805590460904923.504M,36033589280174829503188129.024M,3355540504209422469676472735.0M,3602269794036018329396126.8837M,34177912319597567.130447472485M,12143272909165592059552.8769M,3447186055669601637228.0357989M,32267440921618594532801.409633M,313830266826231524058483.55699M,33546979715547745160420.217344M,3139876669721360367488797.1144M,3138250722238127083131.4644589M,3076161481162450084804803.0559M,3444637415022462359761.6976997M,31877435045391372422499.356773M,341780398426573915086105.77509M,33542052996034888840318772585M,26112138442911583587641.091445M,3187743508056478011291109976.2M,3016202544044858187553.3837413M,360361201448608336749510657.01M,26760032606229903205854.442101M,3140116484905731219375819710.0M,313987191602746948819545.88416M,3444644941358389612944813.6047M,3262700197782319267073.2838262M,34170748378952460834104632.165M,3201041621960170474792.7039593M,12982444761469072636438.1288M,31877468027012803044733.184084M,313987666972136124411822.32436M,310711520810712260478129.27597M,29541790187163572685524005743M,13350796813538043558051.5145M,354158124592220575635921.56024M,26306747406510776904024.548707M,318774775832949.88141070610276M,34472998834298055098504.279141M,326220528472504.32255307641700M,1382965207356333408170364.03M,1383438730995.97218747216995M,35403909529263665263016.114515M,36309097313169683731.196179299M,33551849195523291695037.379694M,313510754087475458422250.75058M,34480318409826817143959.875437M,326366216061036.21515465588851M,22405538898162455176553.918063M,360204237168713991424671.37644M,30158260183278301584883.533568M,34185320827884913166.836984172M,1407608035591088148783.43284M,34131604886095200089946747.503M,3015840305223622418209.6589929M,36039785567034223346.955151104M,23886472953404811397956.199755M,55804063060678991123161.04557M,2806016015621572037493916421M,249526081876743840130872449.7M,404386690221843207009252967.0M,49614694907829718670985835.57M,6196991679941767076174103303M,6189796318392020.66837929986M,898233313805.4714320289661698M,934584772057414160664101385M,10233609048270179755761.013010M,618979668732975022145012738M,3097268540366923729603659008M,8514574921285735088326663M,21761042728380676581528089.61M,2486770446336356289146390804M,24855657817177277335.01599750M,2476031250579979535123809803M,24771598584874913290230.86869M,10233557653624128580431716358M,621463728405618561747714.080M,9285802036866204235379840257M,280601610821023571911285402.1M,3404486279681206724665543425M,27878446444648710.86311408160M,348194395460729303228285216M,280601614539279645564030491.3M,4043894886575741047371796737M,3119078796257402749.28977672M,321588564319024128217587229M,2176128179739868723.776325392M,342372990587688484816656973.6M,24916764135560301535570.84433M,247833113529086511302521856.2M,14808203364881452442.9M
//>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  END ENCODED ASSEMBLY  <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
        }) {
            //Get the bits of the decimal
            var bits = decimal.GetBits(dec);

            //Skip forward if the highest scalar bit is set
            dynamic idx = bits[3] >> 16; //16 for skip tokens, <16 otherwise
            if(idx == 16) asmBufOff += (byte) bits[0];
            else {
                //Accumulate two 4 bit scales, then add to the buffer
                //Note that for even parity tokens, the byte we write here is immediately overwritten again 
                scaleAccum <<= 4;
                TinyBot_asmBuf[asmBufOff++] = scaleAccum |= idx;
                asmBufOff -= scaleParity ^= 1;
            }

            //Add the 88/96 bits of the integer number to the buffer
            idx >>= 4; //1 for skip tokens, 0 otherwise
            while(idx < 12) TinyBot_asmBuf[asmBufOff++] = (byte) (bits[idx / 4] >> idx++ * 8);
        }

        //Load the tiny bot from the assembly
        //We can't just load it and be done with it, because the byte[] overload doesn't add the assembly to the regular load path
        //As such load it whenever any assembly fails to load >:)
        System.ResolveEventHandler asmResolveCB = (_, _) => CurrentDomain.Load(TinyBot_asmBuf); //We can't use a dynamic variable for the callback because we need it to be a delegate type
        CurrentDomain.AssemblyResolve += asmResolveCB;
        TinyBot_asmBuf = CurrentDomain.CreateInstanceAndUnwrap(ToString(), "e");
        CurrentDomain.AssemblyResolve -= asmResolveCB;
    }

    public Move Think(Board board, Timer timer) => TinyBot_asmBuf.Think(board, timer);
}