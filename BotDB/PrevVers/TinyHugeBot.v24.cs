using ChessChallenge.API;
using static System.AppDomain;

class MyBot : IChessBot {
    //TinyBot_asmBuf either holds the TinyBot IChessBot instance, or the assembly buffer during decoding
    dynamic TinyBot_asmBuf = new byte[9216];
    int asmBufOff, scaleParity;
    byte scaleAccum;

    public MyBot() {
        //Decode the assembly
        //The assembly is encoded in a semi-RLE-like format
        //There are two types of tokens:
        // - scaling factors 0-15: regular tokens
        //   - the decimal integer number encodes 12 bytes, which are copied to the assembly buffer
        //   - the decimal scaling factor encodes an additional 4 bits - two regular tokens are paired up, and their scaling factors are combined to form an extra byte
        // - scaling factor 16: skip tokens (can skip up to 255 bytes forward to efficiently encode a stretch of zero bytes)
        //   - the lowest byte of the decimal integer number contains the amount of bytes to skip forward by
        //   - the remaining 11 integer number bytes are copied to the assembly buffer
        //   - skip tokens are invisible to the scalar accumulator; they don't contribute their scale value, nor do they affect parity
        // - the sign bit is unused as a minus sign would require an extra token
        foreach(decimal dec in new[] {
//>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> BEGIN ENCODED ASSEMBLY <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
            73786.976307732568653M,19807040628566.084401472995583M,31105283551.3167525259001891M,990996747008M,155801213958497050427616M,7737125245.5336267181203469M,73786978493861462528M,4352132950.6126650289423364M,41277563240262130762296328704M,7555786.3725983042899970M,1152921504606846992M,0.0000309237645936M,3988510731.4445083921886724M,9444733003122685772288M,0.0000412316868620M,3252766069.4296285444851865M,1099512157696M,944473.2966838802055477M,326431738453956854441574404M,11363902737591853555279511.4M,4722367512021.118822657M,103892062638525357493248M,2775703108121453200379215912M,576664349112622439793756663M,1084181218329891315422068736.4M,983683948207616965215104.8M,31831405518539407403756.46242M,25218622223359216663570025.09M,14551982077674247092598.948867M,149037368037562188881283778.57M,7751751374639693141003212073M,18988901930239290895055349.277M,32049240454754771.328116199258M,10841812183281778010285187483M,790263103275429213814.05722659M,240120837853411429194.37811613M,508638694409746815.64819592273M,48991190960093774542264.182366M,24013270170701829222305981107M,361256680199709077.69030791578M,63282263193841653.994459602791M,63231520512671285690372.123769M,2301580754917457.6867144592616M,23422082515176722098.742582142M,21747235661032022549925.003311M,2445438759561527482428664020.0M,31686992592949182393324022.44M,569539757322231036556.5619542M,29755749920356197552011367.180M,294377927252935746575431386.00M,75220230404142237586.59956332M,93923216182963620344006.66711M,40882797447200520285531750941M,21395871818336778433976825633M,1960940048803.267798553663600M,10179644068488869.48823371776M,26948581442749708197.500546303M,1580092045271978279652761959.9M,498327250934853690893940.0766M,37936483115589975344419359.18M,19825552752952769037972.480772M,3006030927790879471493947726.2M,84650273119214232808536.20319M,5366494984994456643465.583457M,300485032575804622043758855.99M,415138805568644369513997565.72M,3155295614416885279239839824M,7141177226411568399504707360M,20149441034585842105892278018M,14925582640157583231301398.292M,2200256873593913393041822212.5M,2048321837902115748594111236.1M,1495593956123696673501.6433454M,245608118118986161029643.76420M,2326607511236701749.5267200618M,10549291687459635880024757.299M,294655893320416335585052792.97M,3468772543847099059505446.719M,19584821448722.873665573957193M,17729224358629297768882064.953M,15583220888533616503474828.087M,5998814453654994009421.063761M,303940582129866122203003.86581M,260648048352863965557515.48198M,13450921715221516313.958630235M,1898886870643437484654.9745239M,17391872790520381944786870555M,2166415973039774953505767177M,58223614932706880517.66898961M,123794063880.7377420246057986M,12379402756447043929535644.45M,9286534426433288599.18827521M,86861320140031682331.59394608M,35786093207518.6796386844680M,1416940.6417518081346050M,43676090900503957994102328461M,8411981938857016275763.2M,86704159785283330152.41795588M,35786093207659.4171270397966M,6871614.0413101124094466M,30948501195436244226.13067009M,18799740968726407566852101M,1237940103734753018952417536M,217123077227952627023.9916575M,1331278125735402474336277.3535M,536774564085604368558273420.6M,1204794114023980925147140M,65111677483080038232264069727M,5377321255775984538271049816M,712307413096153149694.9620689M,27262522630963464445314208600M,133176165538383650.58318605319M,186788282852040565843843439.6M,30948529685348224461275956.1M,1146312627185594455671650.9989M,31323696142398724.64500035615M,342493442864008489739689098.0M,600636096562754697936798490.5M,2611378486399093204179819341.9M,123794010370713987100233498.4M,245745558575699528334.2M,45199398897768945603882.716435M,79227107459658249091152613638M,1237940140602319480780513024M,4622938505349188498154337384.1M,1237940085262.368734628570128M,97280043971674022658994370.73M,1237940085302985821464170850M,2982809177266549428362753128.1M,3429649379516920088907752372.7M,19844579034275258064329351.008M,356670709049412318433669328.70M,4584421453985293483238227967M,1237940159192031503797715968M,123794017763624230290805558.3M,9908356018173.991364726656320M,11484813733096850599182856M,74675086422830922669572M,681350592010466576115860480.4M,19535108198255746893982349.328M,44275779571583372211279585887M,39098325089286528.763126939648M,1145215429011434188738396.1607M,5266080870781287.562836054289M,78649167645980.581076423970576M,390983250892366.87569689706238M,1145215429011434188738396.1607M,29709347276143944.852196888849M,44275779571583372212425483287M,78917463821746111.575171858432M,2319122901267660928790232830M,5353298275260202044770812928M,9709485349792110658556207377M,3886772381807638372.402159714M,3945873191884.2325322327982338M,35387007158318434058111M,1023363874788700680437308.2129M,298315922350664816876039.37151M,3094852414910322091680.09342M,78917463837737.809826272070693M,789174638376753.43204802568031M,2628607910826374173535698686M,5353298275260202044770812928M,970948534979211065855620737.7M,3945873191886890538814151510.6M,123794019596262105348670243.1M,7803019762633789093897440846.4M,52822602212371514446303060.44M,3096073840436203268082951705.2M,3886772381807638376697127008M,19574016621162694263628431616M,19573874098321619695242788.671M,6911884036020.366982242058047M,4458768243304394983821561499.5M,6210347306617845020156301.587M,590121790227857692958493878.5M,78917463821746.955755395899199M,3106364702321856784310566886.2M,5591300805186263337261076.756M,1145215429011442104815021.2895M,5594115761184515.280959706129M,528067933001520086557432680.1M,8689655489046671943221279M,6031345119275300816198566363M,34357681311967726805960492032M,1237940454146596492791513090M,3990418781566047352782.9103M,681722282803.6272387310780418M,280593243637207147798508545.9M,589230444504912129284.9516888M,280593571679218730755064909.8M,2972265020134477333432292762.4M,5266080870348855895821342870M,29509171326821153486.348179604M,280875067214391661218922753.9M,249646995327316805011020903.3M,14572783715197204115740M,112926233046866092509423897.58M,18175620.6488946523112450M,123794073082409927361363917.2M,123794047242414538488522266.7M,123794049087093233954699061.4M,6813505921184113685434.466856M,68135059212561712794723947.92M,124072245761786057722.03098114M,8973705243272222148334190594M,3559077614791045176355094528.0M,34379432477655815256528650247M,59068307962521551054.11465216M,1934281549171707786297395.7M,185691013560354293990123674.0M,5265079822016363785359790348M,68655182482578274105363.57389M,35059000033148530548268343304M,3736894969171150093473427200M,47962404067852423146283M,127500336828851.1837866792M,3094850364134120186576926.89M,3264007491522910.89824878879M,15782126317.865758423263232M,272625053642201.80070725058837M,56686916596100826137619M,5881424113797081470880268032M,6829221955219212997243176496M,314323546527208469.1865933624M,127500284.9801666206697986M,632259094643238752783174440M,430643619923403364264388614M,438723902305.0302601617604098M,6166562445335414128635448.30M,786091925168334074.75619993089M,13671780057421.159496559886858M,43308355950043.33002665754893M,78644706500158001012640579585M,1705965458873258.8162235760641M,67115698525388969147.8407266M,787873202518395282.97945890839M,5297575273820106096432382221M,15679767880982198792287.29945M,9742746465540233211782846487M,5928572238845176383491343360M,14866245.7419963463043586M,39961612825229564662973700M,2355047854.3559678924701701M,2418442452120144389172996M,85740466751461914651392M,309485048847738115.6279443996M,115605892989896599016571M,62388652319721157439459.0473M,155226075443742013172325413.9M,126132723801401229214.4796761M,1237940527764377679499958021M,303417693505869416783455263.95M,30353855947258180841447448585M,273629373206553625519047381.71M,62129066388064232614741M,126083539269521.7761380886M,51983810124715926522694696M,5261245240749855425371320339M,622672761023055879051019534M,387086764503530471199856472.27M,294010762281126572772263199.02M,309485027223366.6189111001625M,106013884615319904221954M,309485019844668989.4239240826M,3094850530488083221011169802M,9383390909518859.37207809541M,6813572273872079006153857.047M,309485054893482729472072142.3M,7871334900982265308876505644M,32807224429801010898972903936M,42715056338460915620.410364766M,5376598394593179055804.188435M,5906836021895308043079393284M,19535504890078247583170.915371M,38719002884986762559053674M,151707257269828545282051M,14236319896523881358063173633M,12647397121979910.93992693777M,2187004269434230222533.166865M,133104861863613291779.98851587M,42893292021640657279127062M,2187147066045808493946278148M,6813572106265821111.690728296M,588746874203891.0636200852482M,4890959223917616981682703616.9M,408016275217250519505372263.0M,5889966950566365824299304977M,139217724191514.404848654M,5906817070429329129306590724M,577801250060.1200120598M,5556651839915585387015M,590681155471877516008559.2096M,598823517582234056193953410.0M,61665615215683715509145.5237M,281945920226387208842021.44043M,71389387854234135221.89066515M,247966978511730112649805.23269M,68135721062658178.13157483352M,3094850585828315442139824798M,380714919127799589639207046.36M,1237940712375927028670529572M,275841423497962541186477191.72M,12548838902347775362.01950222M,31265239547173.035748687347725M,129551771860122000823315M,123794041715597075.7794495490M,172311179968965479769211M,1274703199644450928232890.8817M,1248901245718752701467071.505M,43401208752527521902025805.07M,105430706656744898149661.48102M,1668464191679107995.088916568M,5906817070357132627000121434M,12379406386649984.51258989317M,5990336072171573071267860741M,15479129010117193.772597062664M,1209516191996150869987587M,38761162834685281720663776M,3806913580163766338974017126.5M,39827096930244972773.376M,6244149081977810064214195722M,644117664144448820142.04134188M,377812496.24689852022666M,3094850623008908069774036990M,10980682925719301394951179795M,13628349064148273373278962688M,4440497964762919285573616920M,1176768392842829641901166.1310M,186181213482036310989675803.3M,992295313028787984344862465.5M,559369982269.7156670216204290M,433968860181647270708902018.78M,526130681586.9862378122580227M,49723591197429387401772.42664M,4040220646008330551102429491M,309485036413412018657699089M,12424210929350439989862728065M,1227854146208007.7848772608M,309485037563.800248327932416M,43304195095281.33714611015181M,1743427832898272062437280974.2M,786540037141010177794.18169346M,79227545047120.534306312686861M,5986709661777.508401893348118M,15905632515574317948611366M,62131232898774103641098M,2726266592424996408282934785.0M,3094850322456697687029190.950M,62131232898774103674674M,33607193470910674.3198750284M,1578211189.8470042391216386M,3094850364134120186.57698833M,314337744978974297381299814.5M,4796305.2586250304096770M,78610401420549631050814419210M,434970583870792.5234452856846M,24826903435430194250421440768M,466285529525226395357374054.4M,662183929727128055261207M,12399952372603294398956115217M,4972359119742938740177242.664M,15782111898470041215243.865M,3094850364134120186.57699857M,314339633925567445239385292.9M,4796305.2586250304096770M,78610401420549631050814419210M,434970583870792.5234519965710M,61346134594348912359945605376M,404022138352.5147277739430147M,5908020480419888867022212136M,133575127308619452579329518.24M,2353295000556642438938401.5358M,23532950005566422190360759.806M,5310902475512602970624.168196M,64123890547667.411061621784105M,69005958020288.35348626279949M,5128050761552532288874M,404022064600833048206307922.4M,6807569139182827147520M,1242662878098966924821214041.7M,3143306614292499929285787658M,309485037563800248327932416M,78621281753765844423371787774M,7871231027360904.4231879458830M,433043922981442119694025268.5M,6810082240403545939812.231168M,5987918882379384617977321235M,2529521864952884.560186899001M,5296511947430894582305981710M,20740635181969018.443538814M,56086913884626692832301877760M,1393409814488679487665248.6656M,6825586138723761220780826631M,26662451213938274091405864M,49014735654126118738153444648M,30948506411736329213999891.15M,589230444649027538085291494.6M,247641285364488404.73279234M,85740472662436896506880M,1393166114786773646.6116532503M,381271837028106908892027361.31M,13328605814526446816152.780800M,309485045158391609860.4637272M,12379407492940709.42759125012M,1804017783473710361031185M,4330391175336085580208017668M,309485047601423097822602856.6M,1292388924837133389698825.772M,76295739696696953350673M,18172248358993.8645522711M,8772169125724543143832.092164M,154948211194774674793383966.89M,123794006681250709792326913.7M,2666244455702440662588318.1M,1237950454305576806910630660.0M,7866610254600139701471792332.8M,1456643773787715676241343847.7M,959665677149085554896302776.2M,181722483589938679077112M,2735207968949044625375494.2078M,123794074929407094338102121.2M,704694446669418109777.8M,433039117533608558020827981.2M,17368845355197312980265.936896M,7542625950099206353594618.719M,9033174228863936982837956.872M,5321772643460411804833813.344M,52914872019198648818681872.59M,46531129551650729112655915M,771313562390896396125475076M,4653904006850.6697032225326082M,11290394664907483772453551448M,1564368900057532177323525120M,8379168747811845785870276169M,19102164490616617303.30942010M,187396287846562863041053979.3M,529397753125217526626833820.3M,837717674099362533699480271.1M,679652946974454380021.246768M,433052894620388327913476082.7M,631059279314620727208.126464M,195355003605370386266456.14459M,6810082240403.559138968666931M,72402709396159519073197.86796M,27262505312198538203.358389507M,3126523954717303574867247462.2M,31261622713585147356540178.714M,125528106832262328579072642.3M,128671313960923130297.9354200M,806743207329.1913599559992834M,74482013840727576741866.49348M,1240490469332.488169005647916M,71230586676361294219180.12261M,50262232736561538.15191038M,526608087164504270489393715.2M,96754978893774123.442287M,4353432082240336745467613444M,80675541351739516668906.08126M,416168066701112038199606787M,26662444268795279164510464M,18311850027286499896284154664M,272988358734473164421762968.27M,1584668092108966454556662670.7M,164236823472513009.65264358146M,45603118917098013584.067854936M,1550593316521997.2504305601323M,5370067640323154649846317.760M,930510227438980742765681.6285M,9617009617401263717173168680M,4330476199467445461924.710189M,433082744284330379640779574.3M,29722650202521.057187337676800M,4815411583564505580583401235M,5986709827811791740028125440M,17354555246192811271864062238M,4330476199467445461924.710189M,433082744284330379640779573.4M,29722650202521057187337.676800M,4815421028297471306988927251M,15191381003075448063935185152M,134495356282504751022626M,4437268277868401573874938.7790M,125526330689811758301419931.1M,3443081120832122055.6759601M,17661660277408421247020.041216M,10005486685644962114505281423M,990480527881.6043788643860994M,528672395911.4680797398827266M,22359130257440.816963047521813M,53787425346736253657.24332031M,380693483142120683877653626.92M,789186775067912087625376727.04M,78724545722251960343526989674M,6470300162165958894218867379.4M,5377765171866212795457605998M,527233622344133860897954.2048M,42893292607089719201767442M,5272333442372192182220755204M,50855481277643392157815049M,691489878035M,3868683515446418491404872089.8M,1879974096943009497.5336448M,4951760747582572546695692544M,9905957055395377253789470605M,12508744.3621485297537026M,30948529668262695089.7861124M,264633861920851.6050498879515M,120951626.0666076341010690M,6238057250460043528493171.20M,38067014665171183018705152M,59269496795220383237120M,4363919977354808604941406271.7M,198413179295839731843085M,5261245259196586790272380947M,98780630370497190425981619.4M,11909139612506.291946538535448M,746515165332.8238443403084802M,44102218367339638310983942M,23002543249024136066539662596M,56668397794435759341890M,270082468487549831492726M,1083197541133.7100614285918978M,108319753938991628728443.86430M,2072098854819601293517615.732M,46484730.4749394457355266M,971464590.6954305348305413M,1844.6768263821130242M,700976274818142830613M,30948501212718807795.5252224M,3777893.1865156184966403M,9444732967938313683200M,897641115969.8970406132121861M,35067979908829706713432070M,464238675014998596400513034M,3096663501714690404388.079104M,3097352994963363083147282688M,12096341776551411651183264M,1209634175206308867735553.5M,185695731026302401562.6043392M,19807087854320752646829473793M,2720084202018442272798151.70M,70836578118251.01766685M,49517648795800626.62791266304M,2785374534494188734278298368M,846314482825183210058548.8M,47148641920549268096024592M,173311605513644753099.13027328M,19807040629935244655804289792M,62864142625309016520130579M,67699845912774698113957.939M,15784056621809489716870905.856M,15784075511275702670696906753M,37114155478726578228219084.8M,144977169.8387756962040834M,14172287595384817076224M,55363594644195835983M,55365846444009521.239M,29091590923422712.596336214784M,29091590923422712596336214784M,62864142620805365353152515M,7253554917772256625452646.7M,928738371453063461624348.672M,1417142.2904251261663235M,14173656689666437441024M,613039077828343263642517609M,587537948332721203520.274433M,41470991316063718.063927723265M,4147099131606.4206247090458115M,4147099131606.7539966345879811M,106429067494269515032M,125733007887883608725651M,773713469033.8702828006049282M,14856777463401191585632766208M,178932605899057884673343505M,189808178997604183225532433M,7738017776257672.289636709632M,2786314311076773376378916608M,24179401932554090117595404M,10883154798180773.025874295M,4425639892318882852.2896464129M,71800564797288519848192700928M,259919217263458976337559799M,427960053750615031.672275191M,1860111824628603362.287292672M,13619465498281501848707797249M,321579451557361929176809492M,18497601747374162045855335.3M,123794009649911104498835148.8M,54161520121871368322174448640M,11215623493040189473004M,11695239401906593726476M,49517602051318.95221531087360M,5570730282853008352573826560M,4295000068M,0.0001099511655174M,43.2345564227591431M,402409376381.6873846665936905M,34161147320976416107829.177088M,34132004069948232352056803377M,20735751578100377962432.181876M,313830266826231524058.52943205M,30145043681445285854993.989934M,34483911301263862.616240320333M,24899514449544774810268.205155M,121432729100790688.213459813M,31389061792901455540845.373507M,325810298159229.50048286008679M,3754802890234240799973.6540261M,122618191025610229141038.452M,24881442809927099855983.109479M,29541790187161040578.427577189M,34808999673231976898600.791885M,326366876277218012217877.07136M,1226326509645680248084.51695M,36022849058114316690785.660001M,35399111531510075839662.347359M,350726968573031736575517.91872M,20874868620866961578606.616949M,12265153912828740962808331.2M,31399942123995644242060141927M,36022849058115994515464216909M,3444644911779631378911.7974879M,31877435155349301599101.321317M,34472998834298055098504.279141M,1250407645975.47544677086052M,2259289899034772682235.7362023M,34170780967078441367474761.289M,2270780333487679551080.0646251M,3567902973229224992749443.0053M,3263547816615035533667.9155026M,3537854961083858958256324.1833M,3137823760493207041903.7384047M,33215715687400256116869785972M,25821920853064016546218.930281M,239457433741621780.10695102569M,21493966420744997676941.864041M,35423134248283792.536597917793M,3449353984810883076617.0112110M,360398605459881063651488025.60M,1394959286887292330321.13509M,33861353113693880039157035.897M,3135886705569596339089.3829733M,356794784862315454157608328.86M,2459004823695984872990.7781955M,34185182643612172544588739173M,13956669025684213065668.4404M,35679478486231.545420022377058M,35382843036257044591912.447557M,3634425536946063542043341117.7M,36034765711131856608855880814M,30147532903097031882564726345M,3138250759045399205927.8354796M,14675837508511196324242.0831M,280714967872.5363732674773764M,156798182523219736127668558.6M,24832849338294286370692.83601M,9296645457978925414177853.52M,1860589317807002913452787712M,186055626124162062691303606.1M,373440024698231046571229236.8M,939472421367465718521660931M,311902991382107435032.511773M,1864201560893906809972140306M,24831621158394543704.16952839M,1240684048599808486528256011M,311907879624043809857013761M,321588564319024128217587229M,4643494108602338393.432593670M,5262534688125053017590007809M,21665462403935812426116.64386M,2176090400810257566428694295M,15535501068784481953.24087047M,9908682174452479619037729045M,2489216078776954442075427089M,2257088430719950545510998.019M,6214257616874554.21494854146M,3405624629193903968137319688M,373438133878112528275.8133767M,2484380486391765354221668360M,24855894122122145127.38633736M,1560761178653485788526547216M,13.4612995M
//>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  END ENCODED ASSEMBLY  <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
        }) {
            //Get the bits of the decimal
            var bits = decimal.GetBits(dec);

            //Skip forward if the highest scalar bit is set
            dynamic idx = bits[3] >> 16; //16 for skip tokens, <16 otherwise
            if(idx == 16) asmBufOff += (byte) bits[0];
            else {
                //Accumulate two 4 bit scales, then add to the buffer
                //Note that for even parity tokens, the byte we write here is immediately overwritten again 
                scaleAccum <<= 4;
                TinyBot_asmBuf[asmBufOff++] = scaleAccum |= idx;
                asmBufOff -= scaleParity ^= 1;
            }

            //Add the 88/96 bits of the integer number to the buffer
            idx >>= 4; //1 for skip tokens, 0 otherwise
            while(idx < 12) TinyBot_asmBuf[asmBufOff++] = (byte) (bits[idx / 4] >> idx++ * 8);
        }

        //Load the tiny bot from the assembly
        //We can't just load it and be done with it, because the byte[] overload doesn't add the assembly to the regular load path
        //As such load it whenever any assembly fails to load >:)
        System.ResolveEventHandler asmResolveCB = (_, _) => CurrentDomain.Load(TinyBot_asmBuf); //We can't use a dynamic variable for the callback because we need it to be a delegate type
        CurrentDomain.AssemblyResolve += asmResolveCB;
        TinyBot_asmBuf = CurrentDomain.CreateInstanceAndUnwrap(ToString(), "e");
        CurrentDomain.AssemblyResolve -= asmResolveCB;
    }

    public Move Think(Board board, Timer timer) => TinyBot_asmBuf.Think(board, timer);
}