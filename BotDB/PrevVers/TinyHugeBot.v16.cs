using ChessChallenge.API;
using static System.AppDomain;

class MyBot : IChessBot {
    //TinyBot_asmBuf either holds the TinyBot IChessBot instance, or the assembly buffer during decoding
    dynamic TinyBot_asmBuf = new byte[9728];
    int asmBufOff, scaleParity;
    byte scaleAccum;

    public MyBot() {
        //Decode the assembly
        //The assembly is encoded in a semi-RLE-like format
        //There are two types of tokens:
        // - scaling factors 0-15: regular tokens
        //   - the decimal integer number encodes 12 bytes, which are copied to the assembly buffer
        //   - the decimal scaling factor encodes an additional 4 bits - two regular tokens are paired up, and their scaling factors are combined to form an extra byte
        // - scaling factor 16: skip tokens (can skip up to 255 bytes forward to efficiently encode a stretch of zero bytes)
        //   - the lowest byte of the decimal integer number contains the amount of bytes to skip forward by
        //   - the remaining 11 integer number bytes are copied to the assembly buffer
        //   - skip tokens are invisible to the scalar accumulator; they don't contribute their scale value, nor do they affect parity
        // - the sign bit is unused as a minus sign would require an extra token
        foreach(decimal dec in new[] {
//>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> BEGIN ENCODED ASSEMBLY <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
            73786.976307732568653M,19807040628566.084401472995583M,31105283551.3167525259001891M,878723100160M,160818728346546048467168M,7737125245.5336267181203469M,73786978493861462528M,4593918114.5355908638835716M,41277563240262130762296328704M,7555786.3725983042899970M,1152921504606846992M,0.0000309237645936M,4116959099.7785627420012036M,9444733005321709027840M,0.0000412316868620M,3386881277.5431264685541529M,1099512154624M,944473.2966838802055477M,326431738453956854441574404M,991319175405429854563.21002M,290919781640315.35772132725248M,29091978164031535772132725248M,123311927817080170671374418M,129356298659891911221.182526M,1733157140020289470.5126563328M,22283336281007940863904473600M,139028111039830691994206303M,96716039386267713989.378141M,2692566337500793911085.1595520M,28782375095264302739373447168M,129356686045458263416111172M,118476464342072736654.491751M,27545053684474989803468779.264M,45495056752884172056101437952M,74956647473182435590144150M,172881317546.359415645667506M,69944594489218467.511715016960M,29091978177506293765365593088M,113640539703248186609893458M,1136405397032481866098.93458M,71192413929524733958768798.72M,16403928636509074447854010881M,37235315547315391562763495.1M,40378622291041060807639063.9M,62049536282407940806156.6977M,6810219170867177267988086273M,35180398063206541391822882.9M,31311770875850314073283.0050M,2909299349148848181156518.4769M,31568878292641922202780905985M,42796461017633910912666857.3M,4521438460091021876498271.00M,2168090419141.800692193269249M,10833741527619139207004496385M,32883641919673228585035406.6M,3094898798293361588566757.38M,321877585885463718363.77633025M,19808254301540275727924006913M,36630900597184930337010506.1M,290146808505.557556693827852M,55722980155712.58965491794432M,11143084867382696331851164161M,35301235304513573292605475.2M,33729731351488855264.3035480M,4023447273589195.3141105631745M,33735141135850376782046896129M,45939743781746332169692802.9M,4630241230459646091132275.71M,136191255076388623442238154.25M,14857164718421857917462477313M,34817744298033165492571378.5M,373565161896777651.482657129M,35901710934753.763711262994945M,45186223446643187137040690177M,48357578819609612910959030.5M,4388455513162545241951439.75M,1485691915370741.3037570413313M,8667582579571765612889858049M,34213220513660760707910899.1M,3493856124811870670560.95601M,3125930828137679708873982.8225M,68708099510146076950172602625M,58512944933149524957947545.9M,523473955818.166128475636211M,62118012405066376.4131958017M,75826051677088479811658177538M,61897835771400259779513589.4M,61051639348637.8802628723149M,5725706914271846.6972729865217M,68089157824774357017677660929M,58392050505866260505047910.8M,563368950587869545800008184M,621335962216706634315588.610M,621128177947307798253666306M,6274417792383492608275911.28M,61535287152949593604181248.1M,7830217731878843026.6621885186M,13929295278470689356085595393M,6298599444677242542180275.17M,61535287153034049411540633.9M,37161152257255884932661944.34M,41785312066414390666923736066M,1079589849553252634858357.743M,1107394387085067.265299907570M,3718131711738.578917587648259M,4956104808742267382300641796M,122224067977582992070528.2961M,123674865660479927.4085188504M,550932383556471.40126829837315M,60663779635250008692044858883M,1169050138863228078373143.544M,11593787138573.15227287815165M,74590420911474882155229.981443M,78923286609215378118295147779M,1218614123673974577259742.177M,127422598420749.9463802487726M,5478395640772872311938.4574211M,61901818846969684817216792835M,1161797672306536851163907.074M,1120692626450067945909781533M,1857364830292848595898176256.4M,14240777887433228329758737156M,1571540847610602394543.8140M,79195521000628.441773796687851M,708720766907225264259061578.23M,4332487906404207578276956159M,79222118051188368417221443541M,792257444228123.68771553886216M,6994372555324906445.4100880383M,64372844261962.365094410064127M,79181014813120.418315061166062M,79188268404926527821088686104M,7118065500423341306.791578880M,8355953596199413712880137216M,4835039203271627398840295M,27805330749.409796121362423M,6808882722993689299616010239M,79228105847956.228777694997504M,79218491439746.843626504454161M,79193104108206675234895167505M,736575126151883457.36193359616M,4951604318326949987500421631M,79115730918849122091053350914M,7911573091882772958.9090058158M,541594375328157.12776819286783M,35280034954656.213820189418239M,78977910442343.590917588385540M,7913748791268519541028768.9502M,2971003202497667580758167.7567M,25067785214161.207019184287231M,79086716459340.298391542235074M,7911814834619043768.7041064872M,625154525194191268193091991.03M,50445631582419.298635676095999M,79118148696681.671380986363817M,79135073436804354478.405320607M,504456599153211932.45590926079M,52921610829533.264749126462463M,79106059881203.442234363871185M,791157304761022127097.87434949M,541594375328157204737.69779455M,54159437532815.712776819286783M,79130237807305.553902853619618M,78863062452559.128472329846690M,92732636593185193518005.4782M,308243014393.674039365123839M,78892074274150.897391596732120M,78918671177137997.413967003288M,43017188521346329726144158718M,14544477891089.990337532190206M,788328393623715.58624668876528M,7875788479941761.1752067497720M,6932297046127715436763221478.2M,73655826713996.505892536621566M,788703137569577.13160694398623M,78911417898913308.146329386652M,51373194065018213481893.003006M,46730928362070.700926001142014M,788860321169018.94068256112379M,788231672917450.84222983634683M,6188203187732675982.109089278M,78917364670059.219378390374655M,789114182678555.08133125750480M,788872392534129475342.67678402M,53539546633982.483815617981694M,48278343965147.427136740450046M,788098687941214.44647783759599M,787167814875604.33495126900432M,6622814869791121600178805.1966M,67156339273843.305235320041214M,788703130744290.26579198377584M,788594333323508387820.49910421M,34351372127664182471233031166M,47659284221190.067627411557886M,787566757444645.96088717246173M,7877601861291894.3834436665028M,6777542735351280552.1371860990M,62823671917152.483729626531070M,788884474597889.95319112728184M,78878775942554710081.087602319M,35589420782531595750858479.870M,46730947253121.922562992826110M,788038241834805.30214181797600M,788134955900425.13767095336672M,739645183475855975958.79080958M,75821537020798.635732214083837M,7859709395756798.8771338124804M,7859709331192969.4327265295875M,76749831491315490332753134.589M,3092403876706.245607327399421M,785983026620331.48453347917305M,78681718672714.047900294249987M,79225791848531226.683032612605M,616759915234.657137021815805M,786043484901636.75742248828471M,786164371027234978288606244.31M,2506592457964487258.2483543806M,16400315969943.901486479967486M,786587492481665.70217581903361M,78672047321514251633878695432M,3092606937168028383810.828286M,1236027444830.504270736267518M,786067658437410.96386633530934M,7862610854617643621145391.8738M,792237895311312967725.40726526M,60964003943595.738266498515707M,779358033806228114.52637707325M,77996249487159183276991052.868M,198019356788438031081.51918332M,33729091690637.395564502443004M,78038560470457941.611187993616M,78074827525616043.051906104290M,4947240780574962234678.857723M,73962232686034.468498063507708M,780010848952784772.97439603760M,780022941346955560539994184.74M,15469400550864416169.785033212M,35895415925042.564272412689148M,78086917743051044.199984659466M,780917532618609360109615175.65M,786049186783740378262701626.84M,924148156362.807415832078587M,78011966500480913.378176334972M,780083399074864139600548.97780M,4022845162588675.3524882872572M,5880139631335878489286918652M,79210029254162513127311278095M,15715500704478539735171070M,278528480873834219404734848.0M,9284441683021450446024732416M,79226953293290343817603055605M,7922211751623729.3883566915561M,2475965080230728768965044.991M,70872199473620.173124412642304M,79196730719646.229778080858142M,483572173026935473733635.6M,139266979414521711.44369007360M,4332842087277127523182307584M,56819310613895222779576339M,19342517974.654512939204587M,3713787063308372270.882233343M,74895580159954.075641482053632M,21760517180.799550968561680M,26596146680444426898440.207M,71800588393700460637947.169536M,21218134336573671364106495M,3094850193330600717317055745M,506272735781985.6818801536M,39614081259514854474644455424M,590724208356.2674686456922115M,78635812794427781769151064838M,77132385876372582411167371.1M,260687667.5507027394495490M,461842910469492194507491840M,7126698117213829000997176320M,71254928643126931024856.57962M,59867329785014581822.46827539M,959789392283599127243371750.9M,21761297917467941995.38206219M,5990341351201641627396278618M,1312049112363905890994961.9970M,618970029298414542081623057M,5818638108483769511710976M,123794006695831113531706675.2M,11806636.783142195699468M,64417659521832441314743688964M,16529003266006283.714560M,4222721074486377234175492M,771353371174351932666349060M,2953526668055.8296512386696194M,298259094666317571836746178.87M,155517682668281958297.56461065M,51663612533221098345924297M,5261245222303099759544774675M,67195572845835.138389368111375M,44005470583468.04943621654287M,34983895368884097985810530305M,3094850340905679284330364.928M,945370730673130577386999294M,3692856879140547848048424M,1237941481809116857877764919.2M,1237941481807182195055250636.8M,5484701039302646937556929742.6M,123794017727.6283271253267971M,592857227573877906.6716740100M,3039254346024.2170289354639874M,5267381145996343053348013880M,137950714908754528094356.89498M,6647930305731348008211971624M,30673560157210559974494833152M,3633199023.6959M,5359959745047064614677248M,6810082203648.532623376845312M,787257126824493.83164324348685M,101439366237364363985677M,4611818252067606815.9905862496M,1258510667687428974.406016878M,123806803026340992634861.88654M,12383060226877715832991907850M,314037408492797456724787.2M,3435767179434707596777776844.8M,589375032768376.99715072M,77826960187913559174916M,218040416026359790134146.6630M,590755.013689169936416M,3626779766.732173085663082M,12089281282911231285246.50M,31154546317290.01290445492525M,32194922763659.907325308698656M,68122876116316.74265433937410M,13124131812741115695371846142M,24904155226053587903876988.11M,3288663772073718836358801.95M,67159456057275828861940007168M,3094850586115419922354933758M,3316560430555.0943397378818M,9310855720624455026203714.56M,15123328350442.7503722503M,1237940361743698755456794368M,13321246052938956887199.579936M,945372467768933171751225603M,3094850451586706599217466385M,3762234132634029491305515793M,945370787382722995309054464M,369285441669190772877337.6M,1084411182561773952050.400296M,309485032246.2875795886833922M,71181696511009685084989719.21M,37372057018239233812.58420252M,154863397499952346805.53475089M,18569101171520182.40972788489M,18774763048687488972025413.34M,24844323027179853350.23763468M,20740634101105107874614142M,15088002502672139318498058M,31262831324434749296984785920M,2499326738838677351864665.445M,143719092270902033545986M,1238794789578973295.4787481617M,5282018931489237438692327443M,47961755837646714.918935M,12415668167851007279780459.62M,618970610310.891894638387207M,5995563728762873371498713856M,380697849613013.81119380323074M,281922541899432507851071.81580M,99112244677461608839.58485969M,123794038019.0438409644998403M,3806933930555563261123900571.3M,32816373697872199211295178752M,590755.285350673421920M,4353360765903.131462495919978M,43533607659034129374.33092490M,868965239057031.7800345361M,3864950050525885348010000656M,34357681311967718009867469824M,1237940306572632907998822432M,231510258033377028004538.7887M,1025229762.6274700071404546M,11461223445889333541078016M,4724684429302910424836M,38761162834685281754218208M,680996420062157830049044889.6M,126101848568350619004306110.3M,4951760765879571932921.333011M,1856910172497036640847663360M,1567991767161476.764660466961M,6865518248257854898327051789M,1369492188794864474.54173216M,18799848733495915337056376.32M,30948503224583908.74855177771M,127500336828851183786884.0M,1330906434838544303393945395.8M,326400638470137797706912029M,955042083243186531250211368M,1733608760320.8904809970204930M,14507109835376870369420886.9M,43946910060375954.016105529492M,719414847980639250928369670M,386977959519558187940273232.59M,294010762281126473816216699.03M,309485073340226.8031715574297M,167404648892625291475714M,309485077029575617.9117900410M,3462467532466680186036224778M,12550634508327346206145259.55M,29538476137339648104935702M,34357671794347076075521190922M,24807157830367642439699661.05M,38728378181274479984902143M,2953042627336.0099201235222274M,29529520158055279372603.687470M,32805425208171043363.005542149M,142363151741573874928805092.79M,993019716877360.9160580273681M,92652847025.3628261310399234M,78635802993104585882716995094M,540995258075719771901329437.9M,4566157878708.7345948440396802M,125488389022886656092458427.5M,17958593050444623032043.640477M,7094462168769894426727153688.0M,402571.3664197499290627M,5460524476247782.329107M,16684642470193402162181.61926M,126101354346646282.4223343448M,3427726651690351773792668689M,133102642354122005616479.55741M,2734481598936678865562999756.9M,1575311528737285552695152.919M,282599979947243902541390.38233M,1767754366887883.88189971M,536894827791904780460884020.2M,433762584153248941872.6968921M,29072504947479667642116M,46463437611944456550.552421M,7743368418164043716418931.200M,3734523876407376407568257321M,5058254355392761543767306756M,5268564927681914450839.602702M,7887999187828741718279771573.6M,4724676828.211487703043M,58937492858998647429747M,314323107559241958744116.5586M,1127567000901.5090739711642114M,464227298560.1408366302530050M,25912333062010734373163724.84M,21132628359941827470557184M,4566157878708734594844039680.0M,15504497694667789965369420.569M,4363098360406748639246090772M,38428148953817656785035.593256M,12410912744758218759742296854M,24201604356342558.465291059200M,34983895368884117845487980030M,12410912744758218428625518.592M,14696410324482717139337228M,78610401420693746238890406154M,39956287728780771740585297165M,132965788613518974582.784M,78640705327171072000448080650M,588634266363695.8933074575365M,9910773869428166213701272070M,928455620341678561397043200M,5570730227168246443878716160M,3094850733069001661103.50609M,78646878326131532997025926675M,434970591574029.3544947482638M,6810082240403545939812231.168M,435336076590172408.4938474109M,343576717943470759377130038.87M,419152045814848539.8528M,598670979089630013058056680.6M,1916281274893956.909150444561M,273429917098786934326.0M,16107560542233452346220391.9M,433074155480.3760078381450498M,4349705915740293544947482638M,13643942315890759375217757992M,10266892322837.321300903133746M,1014393662.37355774053901M,3067356015793226176994338458.6M,13310264236638.067017483771711M,930953518241510683226.936833M,12552808838551825486952.10263M,3126523954731715093704961845.5M,31261622529117681330676568.336M,125528088385518254869521026.3M,2907841453223389.8627672M,12573638002438939774657098.30M,7121994787769.168246654370335M,18739203613883068606530194.35M,589374959556143.33927430M,2187022679861815415520760.068M,2315874478486926317532391.8M,526124518895788716599037388.8M,4381147429546076527665037060M,7157337.0962027544906242M,4486672.286505299219978M,59081577802934.09419636510221M,12549878560755242138580.52894M,904337066812574.2163303953M,2315104014775070964498170880M,9305154784169625552315614208M,2315106082254026460921813015M,3862530336635079800043209728M,621277403092.2248898053342210M,34983895368884111248502967595M,5266080870924466743033266.176M,78635794378229649536654454035M,433082744284330.3796407795733M,3094850494460975051952.357397M,6210650239136865579454960271M,38069891952344968706277988375M,94470408286332.54199296M,309485043313716322879707575.5M,38078745467818115.873162289250M,23256110714298328495696117781M,133188254798016594679268.86917M,280833469741156283548854301.0M,156924741916090883029.6049683M,9914400646458.951515552877096M,77826966.109193473425407M,3435767179434707654132570957.2M,38837107528.164473318277120M,2953042627336.0099201235222274M,4566127491408839259624112542.2M,526608087142887006061528297.6M,3281191097335130299484455171.1M,29825914170479.439485083869714M,156500227023113744695027.3695M,9924724312866298190.060257949M,13660865797405378324.4050845M,30948533357.6115098316964358M,574118871763813.9519860473863M,483629371.9509963529584898M,6238057236048524720914137.60M,12679572453268368396386560M,92326026146510880769024M,4363859531063827873482670502.1M,38695144747629396304592913M,1237940380334254331683209472M,1208949043080600597037.098M,1491715380585.6252695343533060M,1475740370321694275.889M,1700789817.4648995545930M,139514909743529458344656898M,3350433544762.7190782227016195M,9444732965739290452591M,1578612501832893938086094600.7M,350488137404776453632M,309485010397805821330194.432M,2833419.8898317382919683M,4722366486168180098048M,12884901891M,35060140042598255595356161M,185704702809249453.6381563136M,1858723491468520526773874432M,7260638526803342553580174M,12098739985574232923635872M,53540953960948702436.504207360M,71491065630599850647865098242M,515002583731361570349776925M,96715911324442560.39993728M,45184811461586918357099088385M,45807070.1760959720980741M,44875326425247959768352429312M,1640270552406.2120646195289347M,79789104099350844947824657M,90669436557510328075682.099M,928828096416185207939399.681M,1417308.0228914134012675M,14172791998538787606272M,55365846444009521239M,55366972343916.363871M,244493157761025200727900823.04M,309485020629984174414923776M,613041402118096551201210369M,161996059828377661078568967M,41470991316065046273974078208M,7118155225891.4920539459950083M,385652244390988573697M,129938865536848267051142M,1744442185.9831947934074370M,773713469033.8657756536935171M,33736808110105756796199110912M,154747854468987708949069836M,18255704058396824781108028.1M,371459935264125664224935.6544M,11142362350282436120531856128M,43525166534447218414911989M,30225506745101915.662582135M,4611338453803507640.7882711041M,3713938192510782201378428672M,80877345786731866404480636.4M,8027289763431.98034833244255M,30981132541017727024800.75008M,4333016811738748061701118977M,35301152286509091737547574.0M,2309166559118799491324969.05M,1021455900933866783105884083.2M,2785596520450762684344946432M,10881236389714402849325410M,36267783235350202.77432770M,3528301008603741517533680.0768M,1237940081367229600903503104M,7253555092765232037102176M,4295000068M,0.0001099511652614M,43.2345564227592967M,43.2345564227601929M,2073665736357.1612457065693705M,25687255815171642177335001427M,15536455536805590460904923504M,15305521689371591295261100373M,33555405042094224696764.727350M,236615744102517571890753.96462M,3417791231959756713044747.2485M,2197391004391351416039928126.0M,34471860556696016372280.357989M,3138403068305592457609664216.2M,31383026682623152405848355699M,31079543871648365252010997074M,31398766697213603674887.971144M,3602284905811345.4811259425326M,30761614811624500848048.030559M,366537873079430330454523.55924M,31877435045391372422499.356773M,248923087538429859335629.94548M,3354205299603488884031.8772585M,301220464934630950396929.85445M,31877435080564780112911.099762M,353991115315100901075763.44436M,3603612014486083367495.1065701M,301245773300385572257016.31346M,31401164849057312193758197100M,26119392071712808799764243815M,3444644941358389612944.8136047M,35718225355930554749719.871589M,34170748378952460834104.632165M,36025301827633847131.246192494M,1298244476146907263643.81288M,3138250735143637070309637.5656M,31398766697213612441182.232436M,2488017247352428.9974731753728M,2954179018716357268552400.5743M,21354987193173338571.836379251M,35415812459222057563592.156024M,34146111812404640282007262.053M,31877477583294988141070.610276M,341780112320444343374544.48500M,3262205284725043225530.7641700M,14236850672565996729077495.124M,1383438730995972187472.16995M,32634222552839918408535667.577M,36309097313169683731196.179299M,313890479028758.64799386626420M,31351075408747545842225.075058M,3417803982413634.3564194509423M,32636621606103621515465.588851M,31345507628276.799031736300398M,36020423716871399142467137644M,32613731735082163081667962183M,3418532082788491316683.6984172M,3418532082860377718930416.6144M,1407608035591088148783.43284M,34131604886095200089946747.503M,3015840305223622418209.6589929M,36039785567034223346.955151104M,23886472953404811397956.199755M,15692235112398030765609.73677M,32044600988236683449624166.7M,65769357295489517951058126.1M,2485589377048681510687870225M,25109673169508070262.94263816M,6196991530277015065434785288M,8982333229423743508.557201410M,557799799233379686979718426.3M,527455338644287688786837657.8M,2470167112930482035360289M,6191211912890988430972026.88M,2179731179849148182611625738M,2485556246694957332311441666M,2787934147992509273124443143M,24795400056235990280.57933320M,38700034360060243343706888M,3276236586830794815.58635781M,52613963570537760035690265.68M,63838944330967662032690381.1M,32044600981815645092059571.4M,52866610734413.05750995076353M,38699941481207985395663113M,6347663546279597.53824935947M,9909602723682364032897064969M,280601614539139454863494784.1M,5270949871118106790053351681M,32887045415704.4913583687688M,936922417251466985105850626M,404386175622901302.6150287617M,621543841965505024751044360M,3204460107512459.98716420619M,634766483680563072969739537M,52709497782378427978.28900616M,7743960713229M
//>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>  END ENCODED ASSEMBLY  <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
        }) {
            //Get the bits of the decimal
            var bits = decimal.GetBits(dec);

            //Skip forward if the highest scalar bit is set
            dynamic idx = bits[3] >> 16; //16 for skip tokens, <16 otherwise
            if(idx == 16) asmBufOff += (byte) bits[0];
            else {
                //Accumulate two 4 bit scales, then add to the buffer
                //Note that for even parity tokens, the byte we write here is immediately overwritten again 
                scaleAccum <<= 4;
                TinyBot_asmBuf[asmBufOff++] = scaleAccum |= idx;
                asmBufOff -= scaleParity ^= 1;
            }

            //Add the 88/96 bits of the integer number to the buffer
            idx >>= 4; //1 for skip tokens, 0 otherwise
            while(idx < 12) TinyBot_asmBuf[asmBufOff++] = (byte) (bits[idx / 4] >> idx++ * 8);
        }

        //Load the tiny bot from the assembly
        //We can't just load it and be done with it, because the byte[] overload doesn't add the assembly to the regular load path
        //As such load it whenever any assembly fails to load >:)
        System.ResolveEventHandler asmResolveCB = (_, _) => CurrentDomain.Load(TinyBot_asmBuf); //We can't use a dynamic variable for the callback because we need it to be a delegate type
        CurrentDomain.AssemblyResolve += asmResolveCB;
        TinyBot_asmBuf = CurrentDomain.CreateInstanceAndUnwrap(ToString(), "e");
        CurrentDomain.AssemblyResolve -= asmResolveCB;
    }

    public Move Think(Board board, Timer timer) => TinyBot_asmBuf.Think(board, timer);
}